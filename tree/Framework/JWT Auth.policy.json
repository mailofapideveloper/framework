{
  "goid": "7f565a93767ac82901b33a3e5ec9a1e5",
  "guid": "8faf8ccb-5cb2-4501-9daf-eb5d23677e02",
  "name": "JWT Auth",
  "checksum": "87a7b25a6b3c35323073e311bb2a1f772340d666",
  "folderPath": "/Framework",
  "soap": false,
  "policy": {
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Policy Fragment: EnforceSecurity\"/>\n        </L7p:CommentAssertion>\n        <L7p:CustomizeErrorResponse>\n            <L7p:Content stringValue=\"{&quot;errors&quot;:[{&quot;message&quot;:&quot;Token is missing or not sent in a valid format&quot;,&quot;code&quot;:401}]}\"/>\n            <L7p:ContentType stringValue=\"application/json; charset=UTF-8\"/>\n            <L7p:ExtraHeaders nameValuePairArray=\"included\"/>\n            <L7p:HttpStatus stringValue=\"401\"/>\n        </L7p:CustomizeErrorResponse>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLkF1dGhvcml6YXRpb259\"/>\n            <L7p:VariableToSet stringValue=\"RxJWT\"/>\n        </L7p:SetVariable>\n        <L7p:Split>\n            <L7p:InputVariable stringValue=\"RxJWT\"/>\n            <L7p:OutputVariable stringValue=\"RxToken\"/>\n            <L7p:SplitPattern stringValue=\" \"/>\n            <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n        </L7p:Split>\n        <L7p:AuditDetailAssertion>\n            <L7p:Detail stringValue=\"RxToken value is----- ${RxToken[1]}\"/>\n            <L7p:Level stringValue=\"WARNING\"/>\n        </L7p:AuditDetailAssertion>\n        <L7p:DecodeJsonWebToken>\n            <L7p:DetachedJwsContent stringValue=\"\"/>\n            <L7p:SignatureSecret stringValue=\"e71829c351aa4242c2719cbfbe671c09\"/>\n            <L7p:SourcePayload stringValue=\"${RxToken[1]}\"/>\n            <L7p:TargetVariablePrefix stringValue=\"DecodedJWT\"/>\n            <L7p:ValidationType stringValue=\"Using Secret\"/>\n        </L7p:DecodeJsonWebToken>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtEZWNvZGVkSldULmhlYWRlcn0=\"/>\n            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"JWT.header\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtEZWNvZGVkSldULnBheWxvYWR9\"/>\n            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"JWT.payload\"/>\n        </L7p:SetVariable>\n    </wsp:All>\n</wsp:Policy>\n"
  }
}